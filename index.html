<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>منصة متابعة السكر — إعداد Firebase</title>
<style>
  :root{
    --brand:#0ea5e9; --brand2:#6ee7b7; --ink:#0f172a; --muted:#64748b;
    --card:#ffffff; --bg:#f6fbff; --line:#e5e7eb; --danger:#ef4444; --ok:#16a34a;
  }
  *{box-sizing:border-box}
  body{margin:0;font:15px/1.6 system-ui,"Tajawal","Noto Sans Arabic",sans-serif;background:linear-gradient(135deg,var(--brand),var(--brand2)) fixed;color:var(--ink)}
  header{color:#fff;padding:18px}
  header h1{margin:0;font-size:20px}
  main{max-width:1000px;margin:auto;padding:18px}
  .card{background:var(--card);border:1px solid var(--line);border-radius:16px;box-shadow:0 10px 40px rgba(0,0,0,.06);padding:16px;margin-bottom:14px}
  .grid{display:grid;gap:12px;grid-template-columns:repeat(2,minmax(0,1fr))}
  @media(max-width:820px){.grid{grid-template-columns:1fr}}
  .btn{border:none;border-radius:12px;padding:10px 14px;font-weight:700;cursor:pointer}
  .btn.primary{background:var(--brand);color:#fff}
  .btn.gray{background:#eef2f7}
  .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
  .badge{display:inline-flex;gap:6px;align-items:center;padding:6px 10px;border-radius:999px;font-weight:700}
  .ok{background:#ecfdf5;color:#065f46}
  .warn{background:#fff7ed;color:#9a3412}
  .err{background:#fef2f2;color:#991b1b}
  code{background:#f8fafc;border:1px solid var(--line);padding:3px 6px;border-radius:6px}
  .links{display:flex;flex-wrap:wrap;gap:10px}
  .link-btn{display:inline-block;background:#ffffff;border:1px solid var(--line);padding:12px 14px;border-radius:12px;text-decoration:none;color:#0f172a;min-width:160px;text-align:center}
  .link-btn:hover{border-color:#cbd5e1}
  footer{color:#e6faff;text-align:center;padding:10px}
</style>
</head>
<body>
<header>
  <h1>منصة متابعة السكر — نقطة البداية</h1>
  <div style="opacity:.9">الصفحة دي بتجهّز Firebase وتجمع كل روابط الصفحات القادمة.</div>
</header>

<main>
  <!-- حالة الاتصال -->
  <section class="card">
    <div class="row" style="justify-content:space-between">
      <div class="row">
        <span id="sdkBadge" class="badge warn">جارِ التحقق من اتصال Firebase…</span>
        <span id="authBadge" class="badge warn">حالة المستخدم: غير معروف</span>
      </div>
      <div class="row">
        <button id="btnLogout" class="btn gray" title="تسجيل الخروج">خروج</button>
      </div>
    </div>
    <div style="margin-top:8px;color:var(--muted)">
      Project: <code id="proj"></code> • AppId: <code id="appId"></code>
    </div>
    <div id="userBox" style="margin-top:10px"></div>
  </section>

  <!-- روابط الصفحات (Placeholders) -->
  <section class="card">
    <h3 style="margin:0 0 8px">صفحات المشروع</h3>
    <div class="links">
      <a class="link-btn" href="register.html">📝 تسجيل وليّ أمر (Register)</a>
      <a class="link-btn" href="login.html">🔐 تسجيل الدخول (Login)</a>
      <a class="link-btn" href="dashboard.html">📊 لوحة التحكم (Dashboard)</a>
      <a class="link-btn" href="child.html">👧 إدارة طفل (Child)</a>
      <a class="link-btn" href="measure.html">🩺 تسجيل القياسات (Measurements)</a>
      <a class="link-btn" href="report.html">📄 تقارير بين تاريخين (Reports)</a>
    </div>
    <div style="margin-top:10px;color:var(--muted)">
      * الروابط أعلاه مجرد إشارات — هنكمّل كل صفحة في الخطوات الجاية بنفس الهوية البصرية.✔️
    </div>
  </section>

  <!-- ملاحظات سريعة -->
  <section class="card">
    <h3 style="margin:0 0 8px">ملاحظات</h3>
    <ul style="margin:0 0 0 18px;line-height:1.9">
      <li>لو الزر “خروج” غير فعّال، يبقى مفيش مستخدم داخل حاليًا.</li>
      <li>Analytics تشتغل أفضل على <code>https</code> أو <code>localhost</code>.</li>
      <li>الخطوة التالية: بناء <b>register.html</b> و <b>login.html</b> (جاهزين عندنا) وربطهم بالصفحة دي.</li>
    </ul>
  </section>
</main>

<footer>© متابعة السكر للأطفال — جاهزين للانطلاق</footer>

<!-- Firebase setup (باستخدام كودك) -->
<script type="module">
  // استيراد SDKs
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-analytics.js";
  import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-auth.js";
  import { getFirestore } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-firestore.js";

  // 🔧 Firebase config (الخاصة بمشروعك)
  const firebaseConfig = {
    apiKey: "AIzaSyCOdrwdbw8b7YdWLPZ4TDdG2iS9kvvxQ7M",
    authDomain: "child-glucose-tracker.firebaseapp.com",
    projectId: "child-glucose-tracker",
    storageBucket: "child-glucose-tracker.firebasestorage.app",
    messagingSenderId: "294563325904",
    appId: "1:294563325904:web:39562550bf305fc01abbd5",
    measurementId: "G-TWC063TD6X"
  };

  // ▶️ تهيئة Firebase
  const app = initializeApp(firebaseConfig);
  let analytics = null;
  try { analytics = getAnalytics(app); } catch(e){ /* قد لا تعمل خارج https/localhost */ }

  // خدمات رئيسية هنحتاجها في بقية الصفحات
  const auth = getAuth(app);
  const db   = getFirestore(app);

  // ===== واجهة بسيطة توضح الحالة =====
  const $ = s => document.querySelector(s);
  $('#proj').textContent = firebaseConfig.projectId;
  $('#appId').textContent = firebaseConfig.appId;

  const sdkBadge  = $('#sdkBadge');
  const authBadge = $('#authBadge');
  const userBox   = $('#userBox');

  // لو وصلنا هنا يبقى SDK اشتغل
  sdkBadge.textContent = 'Firebase متصل وجاهز';
  sdkBadge.className = 'badge ok';

  function showUser(u){
    if(u){
      authBadge.textContent = 'حالة المستخدم: داخل';
      authBadge.className = 'badge ok';
      userBox.innerHTML = `
        <div class="row">
          <div><b>المستخدم:</b> ${u.displayName || '—'}</div>
          <div><b>البريد:</b> ${u.email}</div>
          <div><b>UID:</b> <code>${u.uid}</code></div>
        </div>`;
    }else{
      authBadge.textContent = 'حالة المستخدم: خارج';
      authBadge.className = 'badge err';
      userBox.innerHTML = '<span style="color:var(--muted)">ليس هناك مستخدم مسجّل دخول الآن.</span>';
    }
  }

  onAuthStateChanged(auth, showUser);
  $('#btnLogout').addEventListener('click', ()=>signOut(auth).catch(()=>{}));
</script>
</body>
</html>
